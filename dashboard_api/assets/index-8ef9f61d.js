import{r as g,u as h}from"./xlsx-17b2b417.js";import{c8 as v,cd as x,ca as w,bW as r}from"./index-27b2444c.js";import{f as y}from"./user-6d708853.js";import{bs as S,r as k,a3 as B,ad as D,y as b,j as I,v as N,x as j,D as C,l as E,C as R}from"./_plugin-vue_export-helper-a4851b7b.js";const V={class:"el-upload__text"},$={__name:"index",setup(A){const t=k(!1),c=v(),l=x();function i(e){return/\.(xlsx|xls|csv)$/.test(e.name)}function d(e){if(!i(e))return r.error("文件类型错误"),!1;u(e.raw)}function u(e){t.value=!0,new Promise(s=>{const a=new FileReader;a.onload=o=>{const _=o.target.result,n=g(_,{type:"binary"}),p=n.SheetNames,m=n.Sheets[p[0]],f=h.sheet_to_json(m);s(f)},a.readAsBinaryString(e)}).then(async s=>{t.value=!1,await y({users:s}),r({message:s.length+c.t("msg.excel.importSuccess"),type:"success"}),await l.push("/user/manage")})}return(e,s)=>{const a=B("el-upload"),o=D("loading");return b((I(),N(a,{class:"upload",drag:"","auto-upload":!1,"show-file-list":!1,"on-change":d},{default:j(()=>[C(w,{icon:"cloud-upload"}),E("div",V,R(e.$t("msg.uploadExcel.upload")),1)]),_:1})),[[o,t.value]])}}},W=S($,[["__scopeId","data-v-d6990399"]]);export{W as default};
