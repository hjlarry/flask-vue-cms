webpackJsonp([2],{"0klK":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={name:"createForm",components:{ArticleDetail:i("e9C3").a}},a={render:function(){var t=this.$createElement;return(this._self._c||t)("article-detail",{attrs:{"is-edit":!1}})},staticRenderFns:[]},o=i("VU/8")(n,a,!1,null,null,null);e.default=o.exports},"1SMQ":function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,"\n.editor-container[data-v-20f29095] {\n  min-height: 300px;\n  margin: 0 0 30px;\n}\n.editor-container .editor-upload-btn-container[data-v-20f29095] {\n    text-align: right;\n    margin-right: 10px;\n}\n.editor-container .editor-upload-btn-container .editor-upload-btn[data-v-20f29095] {\n      display: inline-block;\n}\n",""])},"5dBp":function(t,e,i){var n=i("1SMQ");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i("rjj0")("54cf87aa",n,!0)},AyOV:function(t,e,i){var n=i("kRNi");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i("rjj0")("46530b79",n,!0)},B9RM:function(t,e,i){var n=i("pvO3");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i("rjj0")("518a4650",n,!0)},e9C3:function(t,e,i){"use strict";var n=i("woOf"),a=i.n(n),o=i("//Fk"),s=i.n(o),l=i("fZjL"),r=i.n(l),c={name:"editorSlideUpload",props:{color:{type:String,default:"#1890ff"}},data:function(){return{dialogVisible:!1,listObj:{},fileList:[]}},methods:{checkAllSuccess:function(){var t=this;return r()(this.listObj).every(function(e){return t.listObj[e].hasSuccess})},handleSubmit:function(){var t=this,e=r()(this.listObj).map(function(e){return t.listObj[e]});this.checkAllSuccess()?(console.log(e),this.$emit("successCBK",e),this.listObj={},this.fileList=[],this.dialogVisible=!1):this.$message("请等待所有图片上传成功 或 出现了网络问题，请刷新页面重新上传！")},handleSuccess:function(t,e){for(var i=e.uid,n=r()(this.listObj),a=0,o=n.length;a<o;a++)if(this.listObj[n[a]].uid===i)return this.listObj[n[a]].url=t.files.file,void(this.listObj[n[a]].hasSuccess=!0)},handleRemove:function(t){for(var e=t.uid,i=r()(this.listObj),n=0,a=i.length;n<a;n++)if(this.listObj[i[n]].uid===e)return void delete this.listObj[i[n]]},beforeUpload:function(t){var e=this,i=window.URL||window.webkitURL,n=t.uid;return this.listObj[n]={},new s.a(function(a,o){var s=new Image;s.src=i.createObjectURL(t),s.onload=function(){e.listObj[n]={hasSuccess:!1,uid:t.uid,width:this.width,height:this.height}},a(!0)})}}},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"upload-container"},[i("el-button",{style:{background:t.color,borderColor:t.color},attrs:{icon:"el-icon-upload",size:"mini",type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("上传图片\n  ")]),t._v(" "),i("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-upload",{staticClass:"editor-slide-upload",attrs:{action:"https://httpbin.org/post",multiple:!0,"file-list":t.fileList,"show-file-list":!0,"list-type":"picture-card","on-remove":t.handleRemove,"on-success":t.handleSuccess,"before-upload":t.beforeUpload}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),t._v(" "),i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确 定")])],1)],1)},staticRenderFns:[]};var u=["advlist anchor autolink autoresize autosave bbcode code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools importcss insertdatetime legacyoutput link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"],m=["bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap\t preview anchor pagebreak fullscreen insertdatetime media table emoticons forecolor backcolor"],p={name:"tinymce",components:{editorImage:i("VU/8")(c,d,!1,function(t){i("AyOV")},"data-v-85fd5aa6",null).exports},props:{id:{type:String},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{default:"file edit insert view format table"},height:{type:Number,required:!1,default:360}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id||"vue-tinymce-"+ +new Date}},watch:{value:function(t){var e=this;!this.hasChange&&this.hasInit&&this.$nextTick(function(){return window.tinymce.get(e.tinymceId).setContent(t)})}},mounted:function(){this.initTinymce()},activated:function(){this.initTinymce()},deactivated:function(){this.destroyTinymce()},methods:{initTinymce:function(){var t=this,e=this;window.tinymce.init({selector:"#"+this.tinymceId,height:this.height,body_class:"panel-body ",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:m,menubar:this.menubar,plugins:u,end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["www.tinymce.com","codepen.io"],default_link_target:"_blank",link_title:!1,init_instance_callback:function(i){e.value&&i.setContent(e.value),e.hasInit=!0,i.on("NodeChange Change KeyUp",function(){t.hasChange=!0,t.$emit("input",i.getContent({format:"raw"}))})}})},destroyTinymce:function(){window.tinymce.get(this.tinymceId)&&window.tinymce.get(this.tinymceId).destroy()},setContent:function(t){window.tinymce.get(this.tinymceId).setContent(t)},getContent:function(){window.tinymce.get(this.tinymceId).getContent()},imageSuccessCBK:function(t){var e=this;t.forEach(function(t){window.tinymce.get(e.tinymceId).insertContent('<img class="wscnph" src="'+t.url+'" >')})}},destroyed:function(){this.destroyTinymce()}},h={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tinymce-container editor-container"},[e("textarea",{staticClass:"tinymce-textarea",attrs:{id:this.tinymceId}}),this._v(" "),e("div",{staticClass:"editor-custom-btn-container"},[e("editorImage",{staticClass:"editor-upload-btn",attrs:{color:"#1890ff"},on:{successCBK:this.imageSuccessCBK}})],1)])},staticRenderFns:[]};var f=i("VU/8")(p,h,!1,function(t){i("B9RM")},"data-v-74cfeb61",null).exports,b=i("+mJe"),v=i("viA7"),g=i("TIfe"),y={title:"",content:"",order:"",module_id:"",thumb_pic:""},_={name:"articleDetail",components:{Tinymce:f,MDinput:b.a},props:{isEdit:{type:Boolean,default:!1}},data:function(){return{article:a()({},y),module:{},fileList:[],upload_url:"/admin/upload",upload_header:{Authorization:Object(g.a)()}}},created:function(){this.getModule(),this.isEdit&&this.fetchData()},methods:{onSubmit:function(){var t=this;this.isEdit?Object(v.c)(this.article).then(function(e){0===e.code&&t.$notify({title:"成功",message:"已编辑",type:"success",duration:2e3})}):Object(v.a)(this.article).then(function(e){0===e.code&&(t.$notify({title:"成功",message:"已创建",type:"success",duration:2e3}),a()(t.article,y))})},onClear:function(){a()(this.article,y)},fetchData:function(){var t=this;Object(v.d)(this.$route.query.id).then(function(e){var i=e.data;a()(t.article,i),t.fileList.push({name:"已上传的缩略图",url:Object({NODE_ENV:"production",BASE_API:"/admin"}).SITE_URL+i.thumb_pic})})},getModule:function(){var t=this;Object(v.f)().then(function(e){t.module=e.data})},imgUploadSuccess:function(t,e,i){this.article.thumb_pic=t.data.fileurl},imgRemove:function(t,e){this.article.thumb_pic=""}}},k={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("el-form",{ref:"form",attrs:{model:t.article}},[i("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{prop:"title"}},[i("MDinput",{attrs:{name:"name",required:"",maxlength:100},model:{value:t.article.title,callback:function(e){t.$set(t.article,"title",e)},expression:"article.title"}},[t._v("\n              标题\n            ")])],1),t._v(" "),i("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{prop:"order",label:"顺序"}},[i("el-input-number",{attrs:{size:"small"},model:{value:t.article.order,callback:function(e){t.$set(t.article,"order",e)},expression:"article.order"}})],1),t._v(" "),i("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{prop:"module",label:"模块"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.article.module_id,callback:function(e){t.$set(t.article,"module_id",e)},expression:"article.module_id"}},t._l(t.module,function(t){return i("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}))],1),t._v(" "),i("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{label:"头图"}},[i("el-upload",{staticClass:"upload",attrs:{action:t.upload_url,limit:1,"file-list":t.fileList,"list-type":"picture","on-success":t.imgUploadSuccess,"on-remove":t.imgRemove,headers:t.upload_header}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),t._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb")])],1)],1),t._v(" "),i("div",{staticClass:"editor-container"},[i("tinymce",{ref:"editor",attrs:{height:800},model:{value:t.article.content,callback:function(e){t.$set(t.article,"content",e)},expression:"article.content"}})],1),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("提交")]),t._v(" "),i("el-button",{on:{click:t.onClear}},[t._v("清空")])],1)],1)],1)},staticRenderFns:[]};var w=i("VU/8")(_,k,!1,function(t){i("5dBp")},"data-v-20f29095",null);e.a=w.exports},kRNi:function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,"\n.upload-container .editor-slide-upload[data-v-85fd5aa6] {\n  margin-bottom: 20px;\n}\n",""])},pvO3:function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,"\n.tinymce-container[data-v-74cfeb61] {\n  position: relative\n}\n.tinymce-textarea[data-v-74cfeb61] {\n  visibility: hidden;\n  z-index: -1;\n}\n.editor-custom-btn-container[data-v-74cfeb61] {\n  position: absolute;\n  right: 4px;\n  top: 4px;\n  /*z-index: 2005;*/\n}\n.editor-upload-btn[data-v-74cfeb61] {\n  display: inline-block;\n}\n",""])}});